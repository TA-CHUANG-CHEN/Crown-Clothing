{"ast":null,"code":"var _jsxFileName = \"/Users/dazhuangchen/Desktop/Coding/Crown-Clothing/src/App.js\";\nimport React from \"react\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport CheckoutPage from \"./pages/checkout/checkout.component\";\nimport \"./App.css\";\nimport HomePage from \"./pages/homepage/homepage.component\";\nimport ShopPage from \"./pages/shop/shop.component\";\nimport Header from \"./components/header/header.component\";\nimport SignInSignUpPage from \"./pages/sing-in-sign-up/sign-in-sign-up.component\";\nimport { auth, creatUserProfileDocument, addCollectionAndDocuments } from \"./firebase/firebase.utils\";\nimport { setCurrentUser } from \"./redux/user/user.actions\";\nimport { selectCurrentUser } from \"./redux/user/user.selectors\";\nimport { selectCollectionsForPreview } from \"./redux/shop/shop.selector\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.unsubscribeFromAuth = null;\n  }\n\n  componentDidMount() {\n    // const setCurrentUser = this.props.setCurrentUser; same\n    const {\n      setCurrentUser,\n      collectionArray\n    } = this.props; //this props dispatch from mapDispatchtoProps setCurrentUser\n    // we need react to listening user state.\n\n    this.unsubscribeFromAuth = auth.onAuthStateChanged(async userAuth => {\n      //auth() The Firebase Auth service interface listening auth state like sign-in props is user.\n      //creatUserProfileDocument(user);user(props) => creatUserProfileDocument\n      if (userAuth) {\n        const userRef = await creatUserProfileDocument(userAuth); // if don't exist create do or return user directly.\n\n        userRef.onSnapshot(snapShot => {\n          // const snapshot = await userRef.get(); / retrive uid from users/userAuth.uid\n          setCurrentUser({\n            id: snapShot.id,\n            //  userRef.get().id...\n            ...snapShot.data() //use data() retrived property from  userRef.get().data().\n\n          });\n        });\n      }\n\n      setCurrentUser(userAuth); // CurrentUser is null.\n\n      addCollectionAndDocuments(\"collections\", collectionArray.map(({\n        title,\n        items\n      }) => ({\n        title,\n        items\n      })) // collection\n      );\n    });\n  }\n\n  componentWillUnmount() {\n    this.unsubscribeFromAuth();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          component: HomePage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/shop\",\n          component: ShopPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/checkout\",\n          component: CheckoutPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/signin\",\n          render: () => this.props.currentUser ? /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(SignInSignUpPage, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n  // replace (rootreducer == state) => currentUser: state.user.currentUser\n  collectionArray: selectCollectionsForPreview\n});\n/*\nAbout mapStatetoProps\n\n1.It is called every time the store state changes.\n2.It receives the entire store state, and should return an object of data this component needs, so that why we need reselector.\n\n*/\n\nconst mapDispatchToProps = dispatch => ({\n  setCurrentUser: user => dispatch(setCurrentUser(user))\n});\n/*\nAbout mapDispatchToProps\nReact Redux gives you two ways to let components dispatch actions:\n(dispatch is a function of the Redux store. You call store.dispatch to dispatch an action. This is the only way to trigger a state change)\n1. By default, a connected component receives props.dispatch and can dispatch actions itself.\n2. connect can accept an argument called mapDispatchToProps, which lets you create functions that dispatch when called, \n   and pass those functions as props to your component.\n   ( if you define your own mapDispatchToProps, the connected component will no longer receive dispatch.)\n*/\n\n/* In conclusion,  mapStateToProps can receive props into state everywhere ,mapDispatchToProps is the only way pass state props */\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/dazhuangchen/Desktop/Coding/Crown-Clothing/src/App.js"],"names":["React","Route","Switch","Redirect","connect","createStructuredSelector","CheckoutPage","HomePage","ShopPage","Header","SignInSignUpPage","auth","creatUserProfileDocument","addCollectionAndDocuments","setCurrentUser","selectCurrentUser","selectCollectionsForPreview","App","Component","unsubscribeFromAuth","componentDidMount","collectionArray","props","onAuthStateChanged","userAuth","userRef","onSnapshot","snapShot","id","data","map","title","items","componentWillUnmount","render","currentUser","mapStateToProps","mapDispatchToProps","dispatch","user"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\nimport CheckoutPage from \"./pages/checkout/checkout.component\";\nimport \"./App.css\";\nimport HomePage from \"./pages/homepage/homepage.component\";\nimport ShopPage from \"./pages/shop/shop.component\";\nimport Header from \"./components/header/header.component\";\nimport SignInSignUpPage from \"./pages/sing-in-sign-up/sign-in-sign-up.component\";\nimport {\n  auth,\n  creatUserProfileDocument,\n  addCollectionAndDocuments,\n} from \"./firebase/firebase.utils\";\nimport { setCurrentUser } from \"./redux/user/user.actions\";\nimport { selectCurrentUser } from \"./redux/user/user.selectors\";\nimport { selectCollectionsForPreview } from \"./redux/shop/shop.selector\";\n\nclass App extends React.Component {\n  unsubscribeFromAuth = null;\n\n  componentDidMount() {\n    // const setCurrentUser = this.props.setCurrentUser; same\n    const { setCurrentUser, collectionArray } = this.props; //this props dispatch from mapDispatchtoProps setCurrentUser\n    // we need react to listening user state.\n    this.unsubscribeFromAuth = auth.onAuthStateChanged(async (userAuth) => {\n      //auth() The Firebase Auth service interface listening auth state like sign-in props is user.\n      //creatUserProfileDocument(user);user(props) => creatUserProfileDocument\n      if (userAuth) {\n        const userRef = await creatUserProfileDocument(userAuth); // if don't exist create do or return user directly.\n        userRef.onSnapshot((snapShot) => {\n          // const snapshot = await userRef.get(); / retrive uid from users/userAuth.uid\n          setCurrentUser({\n            id: snapShot.id, //  userRef.get().id...\n            ...snapShot.data(), //use data() retrived property from  userRef.get().data().\n          });\n        });\n      }\n      setCurrentUser(userAuth); // CurrentUser is null.\n      addCollectionAndDocuments(\n        \"collections\",\n        collectionArray.map(({ title, items }) => ({ title, items })) // collection\n      );\n    });\n  }\n  componentWillUnmount() {\n    this.unsubscribeFromAuth();\n  }\n  render() {\n    return (\n      <div>\n        <Header />\n        <Switch>\n          {/* 1. Switch will render the first child <Route> or <Redirect> that matches the location */}\n          <Route exact path=\"/\" component={HomePage} />\n          {/* \n        1. All route props (match, location and history) are available to Homepages \n        2. Routes without a path always match, path='/' means when homepage will be render URL with /. like http://www.test.com/ <- start from here.\n        3. When exact == true, will only match if the path matches the location.pathname exactly.\n        */}\n          <Route path=\"/shop\" component={ShopPage} />\n          <Route exact path=\"/checkout\" component={CheckoutPage} />\n          <Route\n            exact\n            path=\"/signin\"\n            render={() =>\n              this.props.currentUser ? (\n                <Redirect to=\"/\" />\n              ) : (\n                <SignInSignUpPage />\n              )\n            }\n          />\n        </Switch>\n      </div>\n    );\n  }\n}\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser, // replace (rootreducer == state) => currentUser: state.user.currentUser\n  collectionArray: selectCollectionsForPreview,\n});\n/*\nAbout mapStatetoProps\n\n1.It is called every time the store state changes.\n2.It receives the entire store state, and should return an object of data this component needs, so that why we need reselector.\n\n*/\nconst mapDispatchToProps = (dispatch) => ({\n  setCurrentUser: (user) => dispatch(setCurrentUser(user)),\n});\n/*\nAbout mapDispatchToProps\nReact Redux gives you two ways to let components dispatch actions:\n(dispatch is a function of the Redux store. You call store.dispatch to dispatch an action. This is the only way to trigger a state change)\n1. By default, a connected component receives props.dispatch and can dispatch actions itself.\n2. connect can accept an argument called mapDispatchToProps, which lets you create functions that dispatch when called, \n   and pass those functions as props to your component.\n   ( if you define your own mapDispatchToProps, the connected component will no longer receive dispatch.)\n*/\n/* In conclusion,  mapStateToProps can receive props into state everywhere ,mapDispatchToProps is the only way pass state props */\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}